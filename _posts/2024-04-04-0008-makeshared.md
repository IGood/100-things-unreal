---
#layout: post
title: "#8 - `MakeShared`"
date: 2024-02-06 22:22:22 -0800
tags: [smart pointers, tsharedref, tsharedptr]
---
{% include post_header.html %}
Prefer `MakeShared` over `MakeShareable` when creating ref-counted objects.

A heap allocation is expensive, but 2 heap allocations is more expensive.\
`MakeShared` allocates a new object instance & the reference controller in a single memory block, while `MakeShareable` must allocate the reference controller elsewhere.

```cpp
// 👍 write this:
TSharedRef<FMyStruct> ShareMe = MakeShared<FMyStruct>(/*InName=*/TEXT("testme"));

// 👎 not that:
TSharedRef<FMyStruct> ShareMe = MakeShareable(new FMyStruct(/*InName=*/TEXT("testme")));
```

Of course, if you're taking ownership of an object you didn't create, then `MakeShareable` is appropriate.\
But otherwise, `MakeShared` is most likely the better option when creating a new instance.
